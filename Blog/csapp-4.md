---
name: [CSAPP] 第3章 程序的机器级表示
date: 20240529
description: 读完了CSAPP的第3章，也做了对应的两个的lab，写博客做个总结
keywords:read
---

刚读完了CSAPP的第3章程序的机器级表示，也完成了对应的两个lab（boom lab和attrack lab），总结阅读和实验过程中的收获如下，

## 知识整理

### 3.1-3 历史观点\程序编码\数据格式

没什么好总结的，都是些概念性的东西

### 3.4 访问信息

- 整数寄存器

- 寻址方式

- 数据传送指令（mov，movzbw，movsbw，cltq %eax符号扩展到%rax）
- 栈操作（push，pop）

### 3.5 算数和逻辑操作

- 算数和逻辑操作指令（leaq，sal/shl，sar算数右移/shr逻辑右移）
- 特殊操作（imul，mul，idiv，div，cqto %rax符号扩展到%rdx:%rax）

### 3.6 控制

- 条件码（CF，ZF，SF，OF）
- 比较和测试指令（cmp，test）
- SET指令（setz D：D <- ZF）
- 跳转指令（jmp）
- 条件分支的实现（跳转，条件传送）
- 循环（do-while，while，for）
- switch（跳转表）

### 3.7 过程

- 运行时栈
- 控制转移（call，ret）
- 数据传送（%rdi %rsi %rdx %rcx，栈 16(%rsp)）
- 栈上的存储（局部变量，数组）
- 寄存器的保存（调用者\被调用者保存）
- 递归

### 3.8-9 数组分配和访问\异质的数据结构

- 数组地址计算

- 结构体（对齐 K字节的对象地址是K的倍数）

### 3.10 机器级程序

- GDB的使用（layout asm/regs/src）
- 内存越界和缓存溢出

### 3.11 浮点代码

- 浮点寄存器（%ymm0-15）
- 和整数操作类似

## 实验总结

### 1 boom lab

在完成boom lab之前，对这一实验的大名早有耳闻，花了两天的时间把它完成后，确实感叹于世界顶级的计算机课程实验的设计。boom lab以一种有趣且强制的方式，让学生学会了三样东西，

- GDB的使用
- 机器代码的阅读
- 机器代码和高级语言程序的对应

这个实验最难的其实是入手的时候，在没有熟练掌握打断点，单步执行机器指令等GDB基本操作之前，我也不小心把Boom弄炸了一次。但是在炸了一次之后，我学会了使用layout asm/regs实时查看代码和寄存器变化，后面几个任务因为之前其实学过一遍汇编语言，所以还算简单，当然最后一个任务还是有点繁琐，机器代码确实不应该由人来阅读和模拟。

### 2 attrack lab

之前上操作系统或者类似的课程的时候，经常听说缓冲区溢出攻击之类的操作，但是都是耳朵上听了一下，实际的实验却一次也没有过，这次完成了attrack lab才切切实实的了解到缓冲区溢出攻击到底是如何操作的。

总的来说，这个lab的难度相对较低，除了最后一个任务有些繁琐之外，其他几个任务都是按部就班就可以完成的，在完成这个lab的过程中，又更进一步的锻炼了GDB的使用，机器级程序的理解。
